<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Clock</title>

    <script>
        let is12HourFormat = true; // Toggle variable

        function updateTime() {
            let now = new Date();
            let hours = now.getHours();
            let minutes = now.getMinutes();
            let seconds = now.getSeconds();
            let period = hours >= 12 ? "PM" : "AM";

            // Convert to 12-hour format if enabled
            let displayHours = is12HourFormat ? (hours % 12 || 12) : hours;
            let timeString = `${displayHours}:${minutes < 10 ? "0" + minutes : minutes}:${seconds < 10 ? "0" + seconds : seconds}`;

            if (is12HourFormat) {
                timeString += ` ${period}`; // Add AM/PM in 12-hour format
            }

            // Format date
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            let date = now.toLocaleDateString(undefined, options);

            document.getElementById('time').innerHTML = timeString + " <br>on " + date;
        }

        function toggleTimeFormat() {
            is12HourFormat = !is12HourFormat; // Switch format
            updateTime(); // Update time immediately
        }

        async function getCountryTime() {
            let country = document.getElementById("countrySearch").value.trim();
            let timeDisplay = document.getElementById("countryTime");

            if (!country) {
                timeDisplay.innerHTML = "Please enter a country.";
                return;
            }

            try {
                let apiKey = "45KTLLXQNMX3"; // Replace with your TimeZoneDB API Key
                let response = await fetch(`https://api.timezonedb.com/v2.1/get-time-zone?key=${apiKey}&format=json&by=zone&zone=${country}`);

                let data = await response.json();

                if (data.status === "FAILED") {
                    timeDisplay.innerHTML = "Invalid country name. Please try again.";
                    return;
                }

                let dateTime = new Date(data.timestamp * 1000);
                let hours = dateTime.getHours();
                let minutes = dateTime.getMinutes();
                let seconds = dateTime.getSeconds();
                let period = hours >= 12 ? "PM" : "AM";

                let displayHours = is12HourFormat ? (hours % 12 || 12) : hours;
                let timeString = `${displayHours}:${minutes < 10 ? "0" + minutes : minutes}:${seconds < 10 ? "0" + seconds : seconds}`;

                if (is12HourFormat) {
                    timeString += ` ${period}`;
                }

                timeDisplay.innerHTML = `Current time in <b>${country}</b>: ${timeString}`;
            } catch (error) {
                timeDisplay.innerHTML = "Error fetching time.";
                console.error("Fetch Error:", error);
            }
        }

        // Update time every second
        setInterval(updateTime, 1000);
    </script>

    <!-- Link External CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>

    <!-- Full-Width Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">  
            <a class="navbar-brand" href="#">World Clock</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0"></ul>
                <form class="d-flex">
                    <input id="countrySearch" class="form-control me-2" type="search" placeholder="Search country..." aria-label="Search">
                    <button class="btn btn-search" type="button" onclick="getCountryTime()">Search</button>
                </form>
            </div>  -->
        </div>
    </nav>

    <div class="container">
        <div class="jumbotron my-4">
            <h1 class="display-4 my-4">Current time in India is: <span id="time"></span></h1>
            <p class="lead">Time is the most valuable resource we have. Whether you need to check the current time across different time zones or stay on top of your schedule, our World Clock ensures you're always in sync.</p>
            <hr class="my-4">
            <p>Browse and compare time across different countries, and stay in sync no matter where you are!</p>
            <button onclick="toggleTimeFormat()" class="btn btn-primary btn-lg">Toggle</button>
            <p id="countryTime" class="mt-3 text-info"></p>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script> updateTime(); </script>

</body>
</html>
